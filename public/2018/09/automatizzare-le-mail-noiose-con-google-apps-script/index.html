<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=content-language content="en"><meta name=description content="Premessa doverosa: questo post è leggermente aziendalista, perché parla in toni entusiastici di un prodotto dell’azienda per cui lavoro. Tuttavia, disclaimer: è veramente una figata, lo conoscevo un pochino (e lo conosco ancora poco) ma ci si possono fare un sacco di cose meravigliose.
Allora, la situazione è questa: anche se mi sono trasferito da poco all’estero, ho ancora una partita IVA italiana e la avrò ancora per un po’, oltre ad avere una casa in Italia, per cui mi capita spesso di ricevere fatture per spese, bollette e quant’altro che devo girare alla mia commercialista per poter detrarre dalle tasse le spese suddette."><meta name=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="Automatizzare le mail noiose con Google Apps Script"><meta name=twitter:description content="Premessa doverosa: questo post è leggermente aziendalista, perché parla in toni entusiastici di un prodotto dell’azienda per cui lavoro. Tuttavia, disclaimer: è veramente una figata, lo conoscevo un pochino (e lo conosco ancora poco) ma ci si possono fare un sacco di cose meravigliose.
Allora, la situazione è questa: anche se mi sono trasferito da poco all’estero, ho ancora una partita IVA italiana e la avrò ancora per un po’, oltre ad avere una casa in Italia, per cui mi capita spesso di ricevere fatture per spese, bollette e quant’altro che devo girare alla mia commercialista per poter detrarre dalle tasse le spese suddette."><meta property="og:title" content="Automatizzare le mail noiose con Google Apps Script"><meta property="og:description" content="Premessa doverosa: questo post è leggermente aziendalista, perché parla in toni entusiastici di un prodotto dell’azienda per cui lavoro. Tuttavia, disclaimer: è veramente una figata, lo conoscevo un pochino (e lo conosco ancora poco) ma ci si possono fare un sacco di cose meravigliose.
Allora, la situazione è questa: anche se mi sono trasferito da poco all’estero, ho ancora una partita IVA italiana e la avrò ancora per un po’, oltre ad avere una casa in Italia, per cui mi capita spesso di ricevere fatture per spese, bollette e quant’altro che devo girare alla mia commercialista per poter detrarre dalle tasse le spese suddette."><meta property="og:type" content="article"><meta property="og:url" content="http://example.org/2018/09/automatizzare-le-mail-noiose-con-google-apps-script/"><meta property="article:published_time" content="2018-09-21T07:19:04+00:00"><meta property="article:modified_time" content="2018-09-21T07:19:04+00:00"><base href=http://example.org/2018/09/automatizzare-le-mail-noiose-con-google-apps-script/><title>Automatizzare le mail noiose con Google Apps Script · Raibaz.</title><link rel=canonical href=http://example.org/2018/09/automatizzare-le-mail-noiose-con-google-apps-script/><link href="https://fonts.googleapis.com/css?family=Lato:400,700%7CMerriweather:300,700%7CSource+Code+Pro:400,700&display=swap" rel=stylesheet><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.13.0/css/all.css integrity=sha384-Bfad6CLCknfcloXFOyFnlgtENryhrpZCe29RTifKEixXQZ38WheV+i/6YWSzkz3V crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css integrity="sha256-l85OmPOjvil/SOvVt3HnSSjzF1TUMyT9eV0c2BzEGzU=" crossorigin=anonymous><link rel=stylesheet href=/css/coder.min.31a395781f1caab4e90f89f7e5d0f0195b7c1944686a54267ed15c08a820827b.css integrity="sha256-MaOVeB8cqrTpD4n35dDwGVt8GURoalQmftFcCKgggns=" crossorigin=anonymous media=screen><link rel=icon type=image/png href=http://example.org/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=http://example.org/images/favicon-16x16.png sizes=16x16><meta name=generator content="Hugo 0.74.1"></head><body class=colorscheme-light><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=/>Raibaz.</a></section></nav><div class=content><section class="container page"><article><header><h1>Automatizzare le mail noiose con Google Apps Script</h1></header><p>Premessa doverosa: questo post è leggermente aziendalista, perché parla in toni entusiastici di un prodotto dell’azienda per cui lavoro. Tuttavia, disclaimer: è <em>veramente</em> una figata, lo conoscevo un pochino (e lo conosco ancora poco) ma ci si possono fare un sacco di cose meravigliose.</p><p>Allora, la situazione è questa: anche se mi sono trasferito da poco all’estero, ho ancora una partita IVA italiana e la avrò ancora per un po’, oltre ad avere una casa in Italia, per cui mi capita spesso di ricevere fatture per spese, bollette e quant’altro che devo girare alla mia commercialista per poter detrarre dalle tasse le spese suddette.</p><p>In passato, questa cosa la gestivo stampando le fatture e portandole a mano alla commercialista una volta a trimestre: tutti d’accordo, non è neanche lontanamente la soluzione ottimale, ma funzionava, e in fondo passare una volta a trimestre dalla commercialista (o spedirci mia madre quando non avevo tempo di farlo io, lo ammetto) era una discreta occasione di socialità.</p><p>Tuttavia, prendere un aereo una volta a trimestre per andare a portare della carta alla commercialista non mi pare una soluzione fattibile: quando prendo un aereo per tornare a Milano ho tonnellate di cose migliori da fare, senza contare che lo faccio praticamente sempre nei weekend in cui logicamente la commercialista ha anch’essa di meglio da fare.</p><p>Soluzione: “cara commercialista, è un problema per te se le fatture delle spese te le mando per email come già facevo per quelle che emettevo io verso i miei clienti?” Ovviamente no, ma come ogni soluzione che si rispetti questa crea degli altri problemi.</p><p>Mi pare scortese, infatti, spammare la povera commercialista ogni volta che mi arriva una fattura, per cui l’accordo è che le manderò uno zip con un po’ di fatture una volta ogni tanto: ma come faccio a ricordarmi quali fatture le ho già mandato e quali no? E non è uno sbatti allucinante scaricarle tutte, fare lo zip, riallegarlo a una mail nuova e mandarla?</p><p>Certo che lo è, ma io sono un nerd.</p><p>E i nerd odiano fare a mano le operazioni semplici e ripetitive.</p><p>Si dà il caso che il mio attuale datore di lavoro abbia un prodotto, <a href=https://developers.google.com/apps-script/>Google Apps Script</a>, che serve giustappunto a soddisfare questa necessità di qualunque nerd che si rispetti: tra le tante cose che fa, infatti, permette di scrivere pezzettini di codice che interagiscano con diversi altri prodotti Google, principalmente GMail e Google Drive, che sono quelli che interessano a me, ma anche Calendar, Hangouts, Maps e Translate tra gli altri.</p><p>Ora, quello che devo fare io non è altro che quanto segue:</p><ul><li>Prendi tutte le mail con la label “fatture” (ok, questo lo faccio a mano, ma sticazzi)</li><li>Crea una cartella nuova su Google Drive e salvaci tutti gli allegati delle mail prese in precedenza</li><li>Fai uno zip della cartella e mandalo per email alla commercialista, mettendomi in bcc che non si sa mai</li><li>Cancella la cartella</li><li>Togli la label “fatture” a tutte le mail e aggiungi la label “fatture-inviate”</li></ul><p>Una piccola parte dello script (si fa per dire, è praticamente metà del lavoro)</p><p>Sono stato un po’ prolisso e ho cercato di essere ordinato, per cui tutto quanto sopra ammonta a <strong>ben</strong> trentasette righe di script: in pratica ci sto mettendo di più a raccontare quello che ho fatto che a farlo.</p><p>Oltretutto, bonus: GAS è praticamente Javascript, quindi se hai mai scritto del codice in vita tua è facile che tu non faccia troppa fatica ad adattartici, e le API per interagire coi servizi Google sono estremamente semplici e ben documentate: io avevo scritto uno script solo in vita mia, mille anni fa, per cui ero praticamente vergine dell’ambiente di sviluppo, ma le trentasette righe in questione le ho scritte, testate e debuggate in poco più di un’ora.</p><p>Problema risolto, cose imparate, gioia nel cuore.</p><p>Il problema nuovo, perché le soluzioni spesso creano problemi nuovi, è trovare altre cose che posso automatizzare o semplificare usando GAS, visto che adesso mi ci sono affezionato e voglio usarlo per la qualunque.</p><p>Idee?</p></article></section></div><footer class=footer><section class=container>©
2020
·
Powered by <a href=https://gohugo.io/>Hugo</a> & <a href=https://github.com/luizdepra/hugo-coder/>Coder</a>.</section></footer></main></body></html>