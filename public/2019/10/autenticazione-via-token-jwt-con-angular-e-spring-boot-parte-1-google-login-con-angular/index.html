<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=content-language content="en"><meta name=description content="Nella puntata precedente abbiamo descritto il flusso che abbiamo in mente di implementare per separare il frontend e il backend dell’applicazione su cui lavoro e renderli indipendenti.
Il primo step è far fare l’autenticazione via Google login all’applicazione frontend anziché averla incastrata nel backend.
Per farlo, ci viene in aiuto angularx-social-login, un modulo per Angular 4+ che permette di gestire proprio il login con i provider social, come Facebook e, appunto, Google."><meta name=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="Autenticazione via token JWT con Angular e Spring Boot: parte 1, Google login con Angular"><meta name=twitter:description content="Nella puntata precedente abbiamo descritto il flusso che abbiamo in mente di implementare per separare il frontend e il backend dell’applicazione su cui lavoro e renderli indipendenti.
Il primo step è far fare l’autenticazione via Google login all’applicazione frontend anziché averla incastrata nel backend.
Per farlo, ci viene in aiuto angularx-social-login, un modulo per Angular 4+ che permette di gestire proprio il login con i provider social, come Facebook e, appunto, Google."><meta property="og:title" content="Autenticazione via token JWT con Angular e Spring Boot: parte 1, Google login con Angular"><meta property="og:description" content="Nella puntata precedente abbiamo descritto il flusso che abbiamo in mente di implementare per separare il frontend e il backend dell’applicazione su cui lavoro e renderli indipendenti.
Il primo step è far fare l’autenticazione via Google login all’applicazione frontend anziché averla incastrata nel backend.
Per farlo, ci viene in aiuto angularx-social-login, un modulo per Angular 4+ che permette di gestire proprio il login con i provider social, come Facebook e, appunto, Google."><meta property="og:type" content="article"><meta property="og:url" content="http://example.org/2019/10/autenticazione-via-token-jwt-con-angular-e-spring-boot-parte-1-google-login-con-angular/"><meta property="article:published_time" content="2019-10-09T07:50:24+00:00"><meta property="article:modified_time" content="2019-10-09T07:50:24+00:00"><base href=http://example.org/2019/10/autenticazione-via-token-jwt-con-angular-e-spring-boot-parte-1-google-login-con-angular/><title>Autenticazione via token JWT con Angular e Spring Boot: parte 1, Google login con Angular · Raibaz.</title><link rel=canonical href=http://example.org/2019/10/autenticazione-via-token-jwt-con-angular-e-spring-boot-parte-1-google-login-con-angular/><link href="https://fonts.googleapis.com/css?family=Lato:400,700%7CMerriweather:300,700%7CSource+Code+Pro:400,700&display=swap" rel=stylesheet><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.13.0/css/all.css integrity=sha384-Bfad6CLCknfcloXFOyFnlgtENryhrpZCe29RTifKEixXQZ38WheV+i/6YWSzkz3V crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css integrity="sha256-l85OmPOjvil/SOvVt3HnSSjzF1TUMyT9eV0c2BzEGzU=" crossorigin=anonymous><link rel=stylesheet href=/css/coder.min.31a395781f1caab4e90f89f7e5d0f0195b7c1944686a54267ed15c08a820827b.css integrity="sha256-MaOVeB8cqrTpD4n35dDwGVt8GURoalQmftFcCKgggns=" crossorigin=anonymous media=screen><link rel=icon type=image/png href=http://example.org/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=http://example.org/images/favicon-16x16.png sizes=16x16><meta name=generator content="Hugo 0.74.1"></head><body class=colorscheme-light><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=/>Raibaz.</a></section></nav><div class=content><section class="container page"><article><header><h1>Autenticazione via token JWT con Angular e Spring Boot: parte 1, Google login con Angular</h1></header><p><a href=https://raibaz.it/2019/10/autenticazione-via-token-jwt-con-angular-e-spring-boot/>Nella puntata precedente</a> abbiamo descritto il flusso che abbiamo in mente di implementare per separare il frontend e il backend dell’applicazione su cui lavoro e renderli indipendenti.</p><p>Il primo step è far fare l’autenticazione via Google login all’applicazione frontend anziché averla incastrata nel backend.</p><p>Per farlo, ci viene in aiuto <a href=https://github.com/abacritt/angularx-social-login>angularx-social-login</a>, un modulo per Angular 4+ che permette di gestire proprio il login con i provider social, come Facebook e, appunto, Google.</p><p>La logica di login la incapsuliamo in un service, che esporrà all’esterno:</p><ul><li>I metodi <code>login</code>e <code>logout</code>, abbastanza autoesplicativi</li><li>Un metodo <code>getAuthorizationToken</code>, che ritorna il token JWT da usare per l’autenticazione di tutte le chiamate all’API</li><li>Un metodo <code>getLoginState</code>, che ritorna un <code>Observable</code>a cui registrarsi per reagire ai cambiamenti di stato del login dell’utente</li></ul><p>Il motivio per cui ci serve <code>getLoginState</code> è che i token JWT non sono eterni, ma a un certo punto scadranno e le richieste all’API ritorneranno 401, per cui sarà necessario gestire questo caso refreshando il token o sloggando l’utente.</p><p>angularx-social-login stesso, a sua volta, espone una proprietà <code>authState</code> observable, a cui registrarsi per reagire ai cambiamenti di stato del login social: quello che faremo, quindi, è questo:</p><p>Quando cambia lo stato di login social, se l’utente è loggato (<code>user !== null</code>) passiamo token ed email al backend e usiamo la risposta per pubblicare un aggiornamento dello stato del login dell’applicazione, altrimenti pubblichiamo un aggiornamento di stato dicendo all’applicazione che l’utente non è loggato.</p><p>Il login al backend altro non è che una POST a <code>/authenticate</code> con email e idToken di Google, che ritorna un token JWT; il service lo salverà da qualche parte e lo ritornerà col metodo <code>getAuthorizationToken</code>.</p><p>Nel mio caso, il token viene salvato nel <code>sessionStorage</code>; è possibile anche salvarlo in un cookie, e la scelta ha delle implicazioni di sicurezza e implementative non banali che esulano da questa serie di post.</p><p>Nella <a href=https://raibaz.it/2019/10/autenticazione-via-token-jwt-con-angular-e-spring-boot-parte-2-configurazione-di-spring-boot/>prossima puntata</a>, in compenso, inizieremo a vedere come configurare Spring Boot per gestire l’autenticazione e in seguito vedremo come è implementato il metodo <code>/authenticate</code>.</p></article></section></div><footer class=footer><section class=container>©
2020
·
Powered by <a href=https://gohugo.io/>Hugo</a> & <a href=https://github.com/luizdepra/hugo-coder/>Coder</a>.</section></footer></main></body></html>